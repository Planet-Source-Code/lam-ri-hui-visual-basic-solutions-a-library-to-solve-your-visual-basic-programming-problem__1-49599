<html>

<head>
<meta http-equiv="Content-Language" content="en-us">
<meta name="GENERATOR" content="Microsoft FrontPage 5.0">
<meta name="ProgId" content="FrontPage.Editor.Document">
<meta http-equiv="Content-Type" content="text/html; charset=windows-1252">
<title>How to Copy The Desktop Image to a Form</title>
<style>
<!--
 table.MsoNormalTable
	{mso-style-parent:"";
	font-size:10.0pt;
	font-family:"Times New Roman"}
-->
</style>
<meta name="Microsoft Theme" content="studio 011, default">
<meta name="Microsoft Border" content="b, default">
</head>

<body background="../_themes/studio/stubkgnd.gif" bgcolor="#FFFFFF" text="#000000" link="#330099" vlink="#CCCC33" alink="#993333"><!--msnavigation--><table dir="ltr" border="0" cellpadding="0" cellspacing="0" width="100%"><tr><!--msnavigation--><td valign="top"><!--mstheme--><font face="arial, Arial, Helvetica">

<p align="center"><u><b><font size="5">How to Copy The Desktop Image to a Form</font></b></u></p>
<p><i><span style="color: black">This tip could be used in screen grabbing 
software, or even as a screen saver.</span></i> </p>
<p><i><span style="color: black">Module Code</span></i> </p>
<p><i><span style="color: black">Add the following code to a module:</span></i>
</p>
<p><span style="font-size: 10.0pt; font-family: Courier New; color: black">
Declare Function BitBlt Lib &quot;gdi32&quot; _<br>
(ByVal hDestDC As Integer, ByVal x As Integer, _<br>
ByVal y As Integer, ByVal nWidth As Integer, _<br>
ByVal nHeight As Integer, ByVal _<br>
hSrcDC As Integer, ByVal xSrc As Integer, _<br>
ByVal ySrc As Integer, ByVal dwRop As _<br>
Long) As Integer<br>
<br>
Declare Function GetDesktopWindow Lib &quot;user32&quot; () As Long<br>
<br>
Declare Function GetDC Lib &quot;user32&quot; _<br>
(ByVal hwnd As Long) As Long<br>
<br>
Public Const SRCCOPY = &amp;HCC0020<br>
Public Const SRCAND = &amp;H8800C6<br>
Public Const SRCINVERT = &amp;H660046</span> </p>
<p><i><span style="color: black">Form Code</span></i> </p>
<p><i><span style="color: black">Set the Form properties to the following:
</span></i></p>
<!--mstheme--></font><table class="MsoNormalTable" border="1" cellspacing="0" cellpadding="0" width="222" style="width: 166.5pt" bordercolordark="#999966" bordercolorlight="#999966">
  <tr>
    <td width="114" style="width: 85.5pt; padding: .75pt"><!--mstheme--><font face="arial, Arial, Helvetica">
    <p class="MsoNormal"><strong><i><span style="color: black">AutoRedraw</span></i></strong>
    <!--mstheme--></font></td>
    <td width="118" style="width: 88.5pt; padding: .75pt"><!--mstheme--><font face="arial, Arial, Helvetica">
    <p class="MsoNormal"><strong><i><span style="color: black">True</span></i></strong>
    <!--mstheme--></font></td>
  </tr>
  <tr>
    <td width="114" style="width: 85.5pt; padding: .75pt"><!--mstheme--><font face="arial, Arial, Helvetica">
    <p class="MsoNormal"><strong><i><span style="color: black">BorderStyle</span></i></strong>
    <!--mstheme--></font></td>
    <td width="118" style="width: 88.5pt; padding: .75pt"><!--mstheme--><font face="arial, Arial, Helvetica">
    <p class="MsoNormal"><strong><i><span style="color: black">0 - None</span></i></strong>
    <!--mstheme--></font></td>
  </tr>
  <tr>
    <td width="114" style="width: 85.5pt; padding: .75pt"><!--mstheme--><font face="arial, Arial, Helvetica">
    <p class="MsoNormal"><strong><i><span style="color: black">WindowState</span></i></strong>
    <!--mstheme--></font></td>
    <td width="118" style="width: 88.5pt; padding: .75pt"><!--mstheme--><font face="arial, Arial, Helvetica">
    <p class="MsoNormal"><strong><i><span style="color: black">2 - Maximized</span></i></strong>
    <!--mstheme--></font></td>
  </tr>
</table><!--mstheme--><font face="arial, Arial, Helvetica">
<p><i><span style="color: black">Now, add the following code to the form:</span></i>
</p>
<p><span style="font-size: 10.0pt; font-family: Courier New; color: black">
Private Sub Form_Load()<br>
<br>
Dim DeskhWnd As Long, DeskDC As Long<br>
<br>
'Get the hWnd of the desktop<br>
DeskhWnd&amp; = GetDesktopWindow()<br>
<br>
'BitBlt needs the DC to copy the image. So, we<br>
'need the GetDC API.<br>
DeskDC&amp; = GetDC(DeskhWnd&amp;)<br>
<br>
BitBlt Form1.hDC, 0&amp;, 0&amp;, _<br>
Screen.Width, Screen.Height, DeskDC&amp;, _<br>
0&amp;, 0&amp;, SRCCOPY<br>
<br>
End Sub</span> </p>
<p><i><span style="color: black">Add a command button to the form with following 
code: </span></i></p>
<p><span style="font-size: 10.0pt; font-family: Courier New; color: black">
Private Sub Command1_Click()<br>
Unload Me<br>
End<br>
End Sub</span></p>
<p class="MsoNormal">&nbsp;</p>

<!--mstheme--></font><!--msnavigation--></td></tr><!--msnavigation--></table><!--msnavigation--><table border="0" cellpadding="0" cellspacing="0" width="100%"><tr><td><!--mstheme--><font face="arial, Arial, Helvetica">

<p>&nbsp;</p>
<p><a href="../Main.html">Main</a></p>

<!--mstheme--></font></td></tr><!--msnavigation--></table></body>

</html>
