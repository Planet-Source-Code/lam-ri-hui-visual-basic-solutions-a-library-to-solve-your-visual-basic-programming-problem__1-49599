<html>

<head>
<meta http-equiv="Content-Language" content="en-us">
<meta name="GENERATOR" content="Microsoft FrontPage 5.0">
<meta name="ProgId" content="FrontPage.Editor.Document">
<meta http-equiv="Content-Type" content="text/html; charset=windows-1252">
<title>How to Move a Form Without Title Bar</title>
<style>
<!--
 table.MsoNormalTable
	{mso-style-parent:"";
	font-size:10.0pt;
	font-family:"Times New Roman"}
-->
</style>
<meta name="Microsoft Theme" content="studio 011, default">
<meta name="Microsoft Border" content="b, default">
</head>

<body background="../_themes/studio/stubkgnd.gif" bgcolor="#FFFFFF" text="#000000" link="#330099" vlink="#CCCC33" alink="#993333"><!--msnavigation--><table dir="ltr" border="0" cellpadding="0" cellspacing="0" width="100%"><tr><!--msnavigation--><td valign="top"><!--mstheme--><font face="arial, Arial, Helvetica">

<p align="center"><u><b><font size="5">How to Move a Form Without Title Bar</font></b></u></p>
<p class="MsoNormal"><em><span style="color: black">The WM_NCLBUTTON message is 
generated by Windows when a user right-clicks on a window's title bar. Windows 
uses this message to determine whether the window should be moved by further 
user actions. If the title bar does not exist, this message is not generated. 
However, it is often useful to move a window when it doesn't have a title bar. A 
window or form in 32-bit Visual</span></em><i><span style="color: black"><br>
<em>Basic will not have a title bar under the following circumstances:</em></span></i>
</p>
<div align="center">
  <!--mstheme--></font><table class="MsoNormalTable" border="1" cellpadding="0" width="60%" style="width: 60.0%" bordercolordark="#999966" bordercolorlight="#999966">
    <tr>
      <td style="padding: .75pt"><!--mstheme--><font face="arial, Arial, Helvetica">
      <p class="MsoNormal" align="center" style="text-align: center"><strong><i>
      <span style="color: black">Visual Basic 4.0</span></i></strong> <!--mstheme--></font></td>
      <td style="padding: .75pt"><!--mstheme--><font face="arial, Arial, Helvetica">
      <p class="MsoNormal" align="center" style="text-align: center"><strong><i>
      <span style="color: black">Visual Basic 5.0</span></i></strong> <!--mstheme--></font></td>
    </tr>
    <tr>
      <td style="padding: .75pt"><!--mstheme--><font face="arial, Arial, Helvetica">
      <p class="MsoNormal" align="center" style="text-align: center"><em>
      <span style="color: black">Caption = &quot;&quot;</span></em> <!--mstheme--></font></td>
      <td style="padding: .75pt"><!--mstheme--><font face="arial, Arial, Helvetica">
      <p class="MsoNormal" align="center" style="text-align: center"><em>
      <span style="color: black">Caption = &quot;&quot;</span></em> <!--mstheme--></font></td>
    </tr>
    <tr>
      <td style="padding: .75pt"><!--mstheme--><font face="arial, Arial, Helvetica">
      <p class="MsoNormal" align="center" style="text-align: center"><em>
      <span style="color: black">ControlBox = False</span></em> <!--mstheme--></font></td>
      <td style="padding: .75pt"><!--mstheme--><font face="arial, Arial, Helvetica">
      <p class="MsoNormal" align="center" style="text-align: center"><em>
      <span style="color: black">ControlBox = False</span></em> <!--mstheme--></font></td>
    </tr>
    <tr>
      <td style="padding: .75pt"><!--mstheme--><font face="arial, Arial, Helvetica">
      <p class="MsoNormal" align="center" style="text-align: center"><em>
      <span style="color: black">MaxButton = False</span></em> <!--mstheme--></font></td>
      <td style="border: medium none; padding: .75pt"><!--mstheme--><font face="arial, Arial, Helvetica">
      <p class="MsoNormal"><span style="font-size: 10.0pt">&nbsp;</span><!--mstheme--></font></td>
    </tr>
    <tr>
      <td style="padding: .75pt"><!--mstheme--><font face="arial, Arial, Helvetica">
      <p class="MsoNormal" align="center" style="text-align: center"><em>
      <span style="color: black">MinButton = False</span></em> <!--mstheme--></font></td>
      <td style="border: medium none; padding: .75pt"><!--mstheme--><font face="arial, Arial, Helvetica">
      <p class="MsoNormal"><span style="font-size: 10.0pt">&nbsp;</span><!--mstheme--></font></td>
    </tr>
  </table><!--mstheme--><font face="arial, Arial, Helvetica">
</div>
<p class="MsoNormal"><em><span style="color: black">The sample code below 
illustrates a way of letting users move a form without a title bar by simply 
clicking and dragging it from anywhere on the form. The code placed in the 
MouseMove event procedure of Form1 may be placed in other event procedures, if 
so desired. For example, the code</span></em><i><span style="color: black"><br>
<em>could be placed in the MouseDown event procedure of a Label control allowing 
movement of the form by selecting and dragging from the Label control.</em><br>
<br>
<em>NOTE: In Visual Basic 4.0, a form with a menu will have the title bar 
supplied by default so the method demonstrated below is not necessary. In Visual 
Basic 5.0, a form with a menu will not have a title bar supplied by default.</em></span></i>
</p>
<p class="MsoNormal">
<span style="font-size: 10.0pt; font-family: Courier New; color: black">Private 
Declare Function SendMessage Lib &quot;User32&quot; Alias &quot;SendMessageA&quot; (ByVal hWnd As 
Long, ByVal wMsg As Long, ByVal wParam As Long, lParam As Any) As Long<br>
Private Declare Sub ReleaseCapture Lib &quot;User32&quot; ()<br>
Const WM_NCLBUTTONDOWN = &amp;HA1<br>
Const HTCAPTION = 2<br>
Private Sub Form_Load()<br>
Command1.Caption = &quot;Exit&quot;<br>
End Sub<br>
Private Sub Form_MouseMove(Button As Integer, Shift As Integer, X As Single, Y 
As Single)<br>
Dim lngReturnValue As Long<br>
<br>
If Button = 1 Then<br>
Call ReleaseCapture<br>
lngReturnValue = SendMessage(Me.hWnd, WM_NCLBUTTONDOWN, HTCAPTION, 0&amp;)<br>
End If<br>
End Sub<br>
Private Sub Command1_Click()<br>
End<br>
End Sub</span></p>

<!--mstheme--></font><!--msnavigation--></td></tr><!--msnavigation--></table><!--msnavigation--><table border="0" cellpadding="0" cellspacing="0" width="100%"><tr><td><!--mstheme--><font face="arial, Arial, Helvetica">

<p>&nbsp;</p>
<p><a href="../Main.html">Main</a></p>

<!--mstheme--></font></td></tr><!--msnavigation--></table></body>

</html>
